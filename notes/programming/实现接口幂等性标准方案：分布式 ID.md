# 实现接口幂等性标准方案：分布式 ID

给上游提供查询接口，上游自行控制：不安全，容易被模拟网络请求。

通过 [[分布式 ID（全局 ID）解决方案|分布式 ID]] + 存储库实现。

虽然有多种实现方式（[一口气说出四种幂等性解决方案，面试官露出了姨母笑~ - 掘金](https://juejin.cn/post/6906290538761158670#heading-13)），但最好用全局 ID 作为标准，全局 ID 在分布式系统中还可以提供其他作用。

![[Pasted image 20220402160355.png]]

性能问题：重试请求只是偶尔出现，若所有请求来了先查询，再插入会有性能问题。

可以通过 [[MySQL SQL 书写#INSERT ON DUPLICATE KEY UPDATE Statement]] 解决。
