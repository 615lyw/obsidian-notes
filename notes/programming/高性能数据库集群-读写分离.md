---
date created: 2022-07-07, 17:32:25
date modified: 2022-07-07, 17:32:25
---
# Meta

- alias:
- parent :: [[系统设计]]
- siblings :: [[高性能数据库集群-分库分表]]
- child ::
- refs: [14 | 高性能数据库集群：读写分离-极客时间](https://time.geekbang.org/column/article/8269)

---

单机数据库性能不足以支撑业务，需要集群模式。

本质是用数据库作为缓存，分担读压力。

两种集群模式：

- 读写分离
    - 分散访问压力，没有分散存储压力
- 分库分表
    - 既分散访问压力，又分散存储压力

# 读写分离原理

![CleanShot2022-07-07at17.55.28@2x](https://pic-bed-615.oss-cn-beijing.aliyuncs.com/CleanShot%202022-07-07%20at%2017.55.28@2x.png)

- 业务服务器写操作发给主机，读操作发给从机
- 主机通过复制把数据发往从机，主机和从机拥有所有的业务数据

复杂度与解决方案：

- 主从复制延迟
    - 关键业务读写操作全部指向主机，其他业务读写分离
- 分配机制
    - 在代码中引入中间层，由中间层实现数据库连接配置管理、读写分离
        - ![CleanShot2022-07-07at18.13.01@2x](https://pic-bed-615.oss-cn-beijing.aliyuncs.com/CleanShot%202022-07-07%20at%2018.13.01@2x.png)
    - 引入中间件（数据库代理），对于业务服务器看起来就像访问 DB
        - ![CleanShot2022-07-07at18.13.45@2x](https://pic-bed-615.oss-cn-beijing.aliyuncs.com/CleanShot%202022-07-07%20at%2018.13.45@2x.png)

> 我认为读写分离适用单机并发无法支撑并且读的请求更多的情形。在单机数据库情况下，表上加索引一般对查询有优化作用却影响写入速度，读写分离后可以单独对读库进行优化，写库上减少索引，对读写的能力都有提升，且读的提升更多一些。
> 
> 不适用的情况: 
>     1 如果并发写入特别高，单机写入无法支撑，就不适合这种模式。
     2 通过缓存技术或者程序优化能够满足要求